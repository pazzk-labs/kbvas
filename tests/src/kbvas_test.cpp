/*
 * SPDX-FileCopyrightText: 2025 권경환 Kyunghwan Kwon <k@pazzk.net>
 *
 * SPDX-License-Identifier: MIT
 */

#include "CppUTest/TestHarness.h"
#include "CppUTestExt/MockSupport.h"

#include "kbvas.h"
#include "kbvas_memory_backend.h"

#if KBVAS_CELL_VOLTAGE_MAX_COUNT == 960
static const uint8_t sample1[] = {
	0xa1,0x04,0x66,0xbc,0x6d,0x23,0xa2,0x11,0x35,0x59,0x4a,0x5a,0x45,0x43,0x38,0x45,
	0x30,0x32,0x41,0x31,0x33,0x35,0x30,0x32,0x35,0xa3,0x01,0xc6,0xa4,0x01,0x64,0xa5,
	0x02,0x10,0xa1,0xa6,0x02,0x20,0x41,0xa7,0x03,0xc0,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,
	0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0xa8,0x14,0x3f,0x3f,0x3f,0x3f,
	0x3f,0x3f,0x3f,0x3f,0x3f,0x3f,0x3f,0x3f,0x3f,0x3f,0x3f,0x3f,0x3f,0x3f,0x3f,0x3f
};

static const uint8_t sample2[] = {
	0xa1,0x04,0x66,0xbc,0x6d,0x24,0xa2,0x11,0x35,0x59,0x4a,0x5a,0x45,0x43,0x38,0x45,
	0x30,0x32,0x41,0x31,0x33,0x35,0x30,0x32,0x35,0xa3,0x01,0xc5,0xa4,0x01,0x64,0xa5,
	0x02,0x0f,0xa0,0xa6,0x02,0x1f,0x40,0xa7,0x03,0xc0,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,
	0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xc8,0xa8,0x14,0x3e,0x3e,0x3e,0x3e,
	0x3e,0x3e,0x3e,0x3e,0x3e,0x3e,0x3e,0x3e,0x3e,0x3e,0x3e,0x3e,0x3e,0x3e,0x3e,0x3e,
};

const uint8_t expected1[] = {
	0x23,0x6d,0xbc,0x66,0x00,0x00,0x00,0x00,0x6f,0x68,0x45,0x31,0x57,0x55,0x70,0x61,
	0x52,0x55,0x4d,0x34,0x52,0x54,0x41,0x79,0x51,0x54,0x45,0x7a,0x4e,0x54,0x41,0x79,
	0x4e,0x61,0x4d,0x42,0x78,0x71,0x51,0x42,0x5a,0x4b,0x55,0x43,0x45,0x4b,0x47,0x6d,
	0x41,0x69,0x42,0x42,0x70,0x77,0x50,0x41,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,
	0x6c,0x70,0x61,0x57,0x6c,0x70,0x61,0x57,0x71,0x42,0x51,0x2f,0x50,0x7a,0x38,0x2f,
	0x50,0x7a,0x38,0x2f,0x50,0x7a,0x38,0x2f,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};
static const uint8_t expected2[] = {
	0x24,0x6d,0xbc,0x66,0x00,0x00,0x00,0x00,0x6f,0x68,0x45,0x31,0x57,0x55,0x70,0x61,
	0x52,0x55,0x4d,0x34,0x52,0x54,0x41,0x79,0x51,0x54,0x45,0x7a,0x4e,0x54,0x41,0x79,
	0x4e,0x61,0x4d,0x42,0x78,0x61,0x51,0x42,0x5a,0x4b,0x55,0x43,0x44,0x36,0x43,0x6d,
	0x41,0x68,0x39,0x41,0x70,0x77,0x50,0x41,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,
	0x79,0x4d,0x6a,0x49,0x79,0x4d,0x6a,0x49,0x71,0x42,0x51,0x2b,0x50,0x6a,0x34,0x2b,
	0x50,0x6a,0x34,0x2b,0x50,0x6a,0x34,0x2b,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};
#elif KBVAS_CELL_VOLTAGE_MAX_COUNT == 192
#else
#error "Unsupported KBVAS_CELL_VOLTAGE_MAX_COUNT"
#endif

static bool count_iterator(struct kbvas *self,
		const struct kbvas_entry *entry, void *ctx) {
	int *counter = (int *)ctx;
	(*counter)++;
	return true;
}

static bool stop_after_one(struct kbvas *self,
		const struct kbvas_entry *entry, void *ctx) {
	int *counter = (int *)ctx;
	(*counter)++;
	return false;
}

TEST_GROUP(KBVAS) {
	struct kbvas *kbvas;
	struct kbvas_backend_api *backend;

	void setup(void) {
		backend = kbvas_memory_backend_create();
		kbvas = kbvas_create(backend, NULL);
	}
	void teardown(void) {
		kbvas_destroy(kbvas);
		kbvas_memory_backend_destroy(backend);

		mock().checkExpectations();
		mock().clear();
	}
};

TEST(KBVAS, enqueue_ShouldReturnNoError_WhenEnqueueingValidData) {
	LONGS_EQUAL(KBVAS_ERROR_NONE, kbvas_enqueue(kbvas, sample1, sizeof(sample1)));
	LONGS_EQUAL(KBVAS_ERROR_NONE, kbvas_enqueue(kbvas, sample2, sizeof(sample2)));
}

TEST(KBVAS, dequeue_ShouldReturnEntriesInOrder) {
	struct kbvas_entry entry1;
	struct kbvas_entry entry2;

	LONGS_EQUAL(KBVAS_ERROR_NONE, kbvas_enqueue(kbvas, sample1, sizeof(sample1)));
	LONGS_EQUAL(KBVAS_ERROR_NONE, kbvas_enqueue(kbvas, sample2, sizeof(sample2)));

	LONGS_EQUAL(KBVAS_ERROR_NONE, kbvas_dequeue(kbvas, &entry1));
	LONGS_EQUAL(KBVAS_ERROR_NONE, kbvas_dequeue(kbvas, &entry2));

	LONGS_EQUAL(sizeof(expected1), sizeof(entry1));
	LONGS_EQUAL(sizeof(expected2), sizeof(entry2));
	LONGS_EQUAL(0, memcmp(expected1, &entry1, sizeof(expected1)));
	LONGS_EQUAL(0, memcmp(expected2, &entry2, sizeof(expected2)));
}

TEST(KBVAS, peek_ShouldFail_WhenEmpty) {
	struct kbvas_entry entry;
	LONGS_EQUAL(KBVAS_ERROR_NOENT, kbvas_peek(kbvas, &entry));
}

TEST(KBVAS, dequeue_ShouldFail_WhenEmpty) {
	struct kbvas_entry entry;
	LONGS_EQUAL(KBVAS_ERROR_NOENT, kbvas_dequeue(kbvas, &entry));
}

TEST(KBVAS, enqueue_ShouldFailWithInvalidArgs) {
	LONGS_EQUAL(KBVAS_ERROR_MISSING_PARAM, kbvas_enqueue(NULL, "\x00\x01\x02\x03\x04\x05", 6));
	LONGS_EQUAL(KBVAS_ERROR_MISSING_PARAM, kbvas_enqueue(kbvas, NULL, 6));
	LONGS_EQUAL(KBVAS_ERROR_INVALID_FORMAT, kbvas_enqueue(kbvas, "\x00\x01", 2));
}

TEST(KBVAS, clear_batch_ShouldRemoveEntries) {
	kbvas_set_batch_count(kbvas, 2);
	kbvas_enqueue(kbvas, "\xA1\x04\x00\x00\x00\x01", 6);
	kbvas_enqueue(kbvas, "\xA1\x04\x00\x00\x00\x02", 6);

	LONGS_EQUAL(true, kbvas_is_batch_ready(kbvas));
	kbvas_clear_batch(kbvas);
	LONGS_EQUAL(false, kbvas_is_batch_ready(kbvas));
}

TEST(KBVAS, iterate_ShouldVisitAll_WhenMaxCountZero) {
	for (int i = 0; i < 3; ++i) {
		kbvas_enqueue(kbvas, "\xA1\x04\x00\x00\x00\x01", 6);
	}

	int visited = 0;
	kbvas_iterate(kbvas, count_iterator, &visited);
	LONGS_EQUAL(3, visited);
}

TEST(KBVAS, iterate_ShouldStopEarlyWhenCallbackReturnsFalse) {
	for (int i = 0; i < 3; ++i) {
		kbvas_enqueue(kbvas, "\xA1\x04\x00\x00\x00\x01", 6);
	}

	int visited = 0;

	kbvas_iterate(kbvas, stop_after_one, &visited);
	LONGS_EQUAL(1, visited);
}
